---
title: "Factors affecting the opinion on RFID system introduction among dental professionals"
date: "26/05/2021"
output: 
  html_document:
    df_print: paged
---
<br>


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(labelled)
library(gtsummary)
library(flextable)

# import data
library(readxl)
dental.df <- read_excel("20200331 questionnair for dental stuff.xlsx", sheet = "dentist (original)")
nursing.df <- read_excel("Rev3-3 questionnaire for nursing care stuff0308.xlsx", sheet = "Sheet1")


glimpse(nursing.df)

load("isudata.RData")


```


<!-- ============================Import data================================ -->
```{r dental.data, include=FALSE}

varlist_den <- c("forensic odontologist", 
             "q4_experience",
             "q6_knowRFID",
             "q11_num_of_other_systems",
             "experienced other systems",
             "q19_RFID_system_introduce")

varlist_nur <- c("Q1_Occupation", 
             "Q3_work_experience",
             "Q19_heard_RFID?",
             "Q21_know_other_systems?",
             "Q11_missing_denture",
             "Q25_denture_make_RFID?")


clean_den <- mutate(
  Speciality= if_else(`forensic odontologist`==1, "Forensic Odontologist", "Other"),
  Experience= if_else(q4_experience== 1, "<10 years", ">=10 years"),
  Know_RFID= if_else(q6_knowRFID== 1, "Yes", "No"),
  Know_other= if_else(q11_num_of_other_systems==0,"No","Yes"),
  Other_systems_exp= if_else(`experienced other systems`==1, "Yes","No"),
  Introduce_RFID= case_when(q19_RFID_system_introduce== 1~ "Widely introduce",
                            q19_RFID_system_introduce== 2~ "Introduce on request",
                            TRUE ~ "Aginst RFID"),
  Widely_introduce= if_else(q19_RFID_system_introduce== 1,"Yes","No"),
  Against_RFID= if_else(q19_RFID_system_introduce< 3,"No","Against"))

tab.fun <- function(df,varlist,clean,headvar) {
  
  data.den <- df %>%
    select(varlist) %>% 
    mutate_all(as.numeric) %>% 
    filter(!is.na(.)) %>% 
    clean %>% 
    mutate_all(as.factor) %>%
    
    select(Speciality:Against_RFID) %>% 
    
    set_variable_labels( Speciality= "Forensic or other dental speciality",
                         Experience= "Years of experience in the field",
                         Know_RFID= "Know about RFID",
                         Know_other= "Know about other systems",
                         Introduce_RFID= "Opinion on RFID introduction",
                         Other_systems_exp= "Experience with other systems",
                         Widely_introduce= "Introduce RFID widely",
                         Against_RFID= "Aginst introduction of RFID") %>%
    select(headvar, Introduce_RFID, Against_RFID ) 
  
  header <- var_label(data.den[headvar])[[1]]
  
  
  tabl <- tbl_summary(data.den,by= headvar)  %>%  
    
    add_p() %>% 
    
    modify_spanning_header(c("stat_1", "stat_2") ~ header) %>% 
    bold_labels() %>% 
    as_flex_table()
  
  return(tabl)
}


```
  
  

#### *Difference in opinion among professionals with and without exprience identification systems*

> derived from **Question 13** (respondents who had  exprience with unidentified 
case or who has identification set-up in their clinic were recored as having **exprience 
with other systems**)

```{r, echo=FALSE, message=FALSE}

tab.fun(dental.df,"Other_systems_exp")

# tab.fun(dental.df,"Know_other")
# 
# tab.fun(dental.df,"Speciality")
```


#### *Difference in opinion based on the years of experience*

```{r, echo=FALSE, message=FALSE}
tab.fun(dental.df,"Experience")
```

#### *Difference in opinion based on the speciality*

```{r}
tab.fun(dental.df,"Speciality")

```




